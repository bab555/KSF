# 知识合成框架 (Knowledge-Synthesized-Framework, KSF) v3

## 1. 项目简介与架构演进

知识合成框架 (KSF) 是一套先进的模块化系统，旨在通过动态生成高度优化的、情境感知的内容，增强在特定知识领域的响应能力。

### V3架构升级：从"注入"到"协作"

KSF v3是一次彻底的架构重构，其核心是从一个单向的"注入"模型，演进为一个双向的"动态协作"模型。

**为何放弃V1的"偏置注入" (Bias Injection)方案？**
旧版KSF曾探索通过"偏置注入"技术直接影响模型内部权重。然而，该方案存在根本性缺陷：
*   **泛化性差**：与特定模型架构深度耦合，难以适应快速迭代的模型。
*   **接口废弃**：现代高级大语言模型（LLM）出于安全、稳定和黑盒化的考虑，已普遍**不再提供或支持**此类深入内部的偏置调整接口。

因此，KSF v3转向了一个更灵活、更健壮的全新范式。

---

## 2. 核心理念与技术架构

### 2.1. K-S动态协作模型

KSF v3的核心思想，是将复杂的知识合成任务解耦为两个独立但紧密协作的模块：

*   🧠 **K-Module (知识发现器)**: 扮演**"直觉引擎"**角色。它负责基于向量相似性和图结构重要性，进行快速、发散的知识探索。
*   🎯 **S-Module (提示装配引擎)**: 扮演**"逻辑引擎"**角色。它负责分析用户意图，对K模块的检索过程进行**"校正指导"**，最终装配出结构清晰的答案。

这种 **"K-first, S-corrects"** 的动态协作，由一个中心**Orchestrator（编排器）** 指挥，使得整个系统既有广度又有深度。

### 2.2. K-Module: "语义检索 + 图重排序"双阶段引擎

K模块通过一套"组合拳"来确保检索到的知识既**相关**又**重要**。

*   **阶段一：语义检索 (Semantic Retrieval)**
    *   **核心模型**: 采用 `Snowflake/snowflake-arctic-embed-m` 作为基础语义模型，并加载了针对特定领域微调的**PEFT适配器**。
    *   **实现**: 将知识点预处理为`FAISS`向量索引，进行高效的向量相似度搜索。

*   **阶段二：图重排序 (Graph-based Reranking)**
    *   **核心思想**: 评估知识在整个知识体系中的**"结构重要性"**。
    *   **实现**: 离线构建知识图谱并运行**PageRank算法**计算全局权重，再结合语义相似分进行重排序。
        \[
        \text{Final Score} = \alpha \times (\text{PageRank Weight}) + (1 - \alpha) \times (\text{Original Similarity})
        \]

### 2.3. S-Module: 具备"工具箱"的智能分析核心

S模块是系统的"大脑"，通过内置的"智能工具箱"来理解和组织信息。
*   **核心功能**: 意图分析、实体识别、生成指导K模块的**"检索指令"** (`RetrievalInstruction`)，并利用`Jinja2`模板引擎进行最终答案装配。

---

## 3. 快速开始

### 3.1. 环境要求
- Python 3.8+
- PyTorch 2.7+
- CUDA 支持的GPU（推荐）

### 3.2. 安装与运行
1.  **安装依赖**:
    ```bash
    pip install -r requirements.txt
    ```
2.  **准备模型与数据**:
    *   确保您的基础模型 (如 `snowflake-arctic-embed-m`) 已下载。
    *   确保您的知识库文件 (如 `云和文旅知识库数据集.json`) 已放在`data/`目录下。
3.  **检查配置**:
    *   打开 `demo_ksf_v3.py`，检查 `config` 字典中的模型和文件路径是否正确。
4.  **运行演示**:
    ```bash
    python demo_ksf_v3.py
    ```

---

## 4. 项目信息

### 4.1. 项目结构
```
Knowledge-Synthesized-Framework/
├── ksf/                  # 核心框架代码
│   ├── core/             # 编排器
│   ├── k_module/         # K模块
│   └── s_module/         # S模块
├── configs/              # 配置文件
├── data/                 # 数据与知识库
├── scripts/              # 工具脚本
├── checkpoints/          # 模型检查点与索引
└── demo_ksf_v3.py        # 演示脚本
```

### 4.2. 贡献与联系
- **开发者**: 易尘/bab555
- **邮箱**: bab55@163.com
- **GitHub**: [https://github.com/bab555/ksf](https://github.com/bab555/ksf)

欢迎提交Issue和Pull Request！

### 4.3. 许可证
本项目采用 **CC BY-NC-SA 4.0** 许可证 - 详见 [LICENSE](LICENSE) 文件。
⚠️ **重要说明**: 本项目仅供**非商业用途**使用。商业使用请联系开发者获取授权。

---
**开发团队**: 红点天枢 